# Распространение приложений на Qt, или как найти нужные DLL - windeployqt.exe

Проблема распространения приложения на Qt пользователю - больная тема для большинства разработчиков.
Оказывается, она упрощается с помощью утилиты от самих разработчиков Qt. Но к сожалению эта утилита упоминается очень редко, так что я сам узнал о ней только что. Возможно у неё есть недостатки, пока мне неизвестные но на первый взгляд она удобная, если бы не была консольной. Но с последней проблемой мы можем справиться).

Откроем Qt Creator, зайдём в меню "Инструменты"- подпункт "Параметры", слева пункт "Среда", вкладка "Внешние утилиты".
И в нижнем меню "Дабавить" выберем вначале "Новый раздел" (я выбрал ёмко и просто - ) "Добавить утилиту" (соответственно "windeployqt")
И справа заполним следующим образом:

Описание: "Эта утилита добавляет необходимые DLL в папку с EXE"
Программа: %{CurrentProject:QT_INSTALL_BINS}\windeployqt.exe
Параметры: --compiler-runtime %{CurrentProject:BuildPath}\%{CurrentBuild:Type}
Среда: PATH=C:\Qt\Qt_5.9\Tools\mingw530_32\bin;${PATH}
*Адрес компилятора нужен, поскольку DLL из его поставки нам тоже понадобятся. Папка установки Qt: C:\Qt\Qt_5.9*

*В параметрах нужно указать строку, где создаётся наш EXE.) А поскольку редактировать настройки каждый раз неудобно, соберём путь из заботливо предоставленных авторами Qt переменных. У меня расположение компилятора из системной переменной не подхватилось, на всякий случай добавил.*

Можно добавить параметры, отвечающие за копирование плагинов, платформ и т.д. Подробнее:
http://doc.qt.io/qt-5/windows-deployment.html

Всё, можно собирать проект, затем вызывать нашу утилиту  и смотреть каталог! Для удаление мусора из каталога - пункт "Очистить" из меню "Сборка".
Не забудьте добавить те бибилиотеки, которые вы импортировали сами!

## Запуск "на месте"
Чтобы не копировать каждый раз DLL компилятора и Qt в папку с exe, придётся добавить в системную переменную следующие значения (пример для Qt 5.9.0, папка установки C:\Qt\Qt_5.9):
C:\Qt\Qt_5.9\Tools\mingw530_32\bin
C:\Qt\Qt_5.9\5.9\mingw53_32\bin
*Адрес компилятора нужен, поскольку DLL из его поставки нам тоже понадобятся.*
*Чтобы изменить системные переменные, можно в диалоге "Выполнить" ОС Windiws запустить sysdm.cpl .*
*Так же можно поэкспериментировать с переменными среды самого Qt Creator.*
